{"version":3,"file":"RangeSelector.js","sourceRoot":"","sources":["../../../../../src/.internal/plugins/rangeSelector/RangeSelector.ts"],"names":[],"mappings":"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","sourcesContent":["/**\r\n * Base class for axis range selector classes.\r\n */\r\n\r\n/**\r\n * ============================================================================\r\n * IMPORTS\r\n * ============================================================================\r\n * @hidden\r\n */\r\nimport { Axis } from \"../../charts/axes/Axis\";\r\nimport { AxisRenderer } from \"../../charts/axes/AxisRenderer\";\r\nimport { Validatable, IValidatableEvents } from \"../../core/utils/Validatable\";\r\nimport { registry } from \"../../core/Registry\";\r\nimport { MutableValueDisposer } from \"../../core/utils/Disposer\";\r\nimport { Language } from \"../../core/utils/Language\";\r\nimport selectorCSS from \"./RangeSelectorCSS\";\r\nimport * as $dom from \"../../core/utils/DOM\";\r\nimport * as $type from \"../../core/utils/Type\";\r\n\r\n\r\n/**\r\n * ============================================================================\r\n * REQUISITES\r\n * ============================================================================\r\n * @hidden\r\n */\r\n\r\n/**\r\n * Defines events for [[RangeSelector]].\r\n */\r\nexport interface IRangeSelectorEvents extends IValidatableEvents {\r\n\r\n\t/**\r\n\t * Invoked when position of the control changes.\r\n\t */\r\n\tpositionset: {\r\n\t\tprevPosition: \"top\" | \"bottom\" | \"left\" | \"right\";\r\n\t\tposition: \"top\" | \"bottom\" | \"left\" | \"right\";\r\n\t}\r\n\r\n\t/**\r\n\t * Invoked when control is drawn.\r\n\t */\r\n\tdrawn: {}\r\n\r\n}\r\n\r\n\r\n/**\r\n * ============================================================================\r\n * MAIN CLASS\r\n * ============================================================================\r\n * @hidden\r\n */\r\n\r\n/**\r\n * A base class for axis-specific range selectors.\r\n */\r\nexport class RangeSelector extends Validatable {\r\n\r\n\t/**\r\n\t * Defines available events.\r\n\t */\r\n\tpublic _events!: IRangeSelectorEvents;\r\n\r\n\t/**\r\n\t * An instance of [[Language]].\r\n\t */\r\n\tprotected _language = new MutableValueDisposer<Language>();\r\n\r\n\t/**\r\n\t * Reference to DOM element that holds the control element.\r\n\t */\r\n\tprotected _container: $type.Optional<HTMLElement>;\r\n\r\n\t/**\r\n\t * Control element.\r\n\t */\r\n\tprotected _element: $type.Optional<HTMLElement>;\r\n\r\n\t/**\r\n\t * Prefix for class names applied to control elements.\r\n\t */\r\n\tprotected _classPrefix: string = \"amcharts-range-selector\";\r\n\r\n\t/**\r\n\t * If set to `true` [[RangeSelector]] will load it's own external CSS when\r\n\t * instantiated.\r\n\t */\r\n\tprotected _defaultStyles: boolean = true;\r\n\r\n\t/**\r\n\t * Holds references to various HTML elements control consists of.\r\n\t */\r\n\tprotected _elements: {\r\n\t\twrapper?: HTMLElement;\r\n\t} = {};\r\n\r\n\t/**\r\n\t * Position of the selector.\r\n\t */\r\n\tprotected _position: \"top\" | \"bottom\" | \"left\" | \"right\" = \"bottom\";\r\n\r\n\t/**\r\n\t * A tabindex to apply to control.\r\n\t */\r\n\tprotected _tabindex: number = 0;\r\n\r\n\t/**\r\n\t * Reference to target axis.\r\n\t * \r\n\t * @ignore\r\n\t */\r\n\tpublic _axis: Axis<AxisRenderer>;\r\n\r\n\t/**\r\n\t * Constructor\r\n\t */\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.className = \"RangeSelector\";\r\n\t\tthis._disposers.push(this._language);\r\n\t\tthis.invalidate();\r\n\t\tthis.applyTheme();\r\n\t}\r\n\r\n\t/**\r\n\t * (Re)draws the control.\r\n\t *\r\n\t * @ignore Exclude from docs\r\n\t */\r\n\tpublic validate(): void {\r\n\t\tthis.draw();\r\n\t\tsuper.validate();\r\n\t}\r\n\r\n\t/**\r\n\t * Draws the control.\r\n\t *\r\n\t * @ignore\r\n\t */\r\n\tpublic draw(): void {\r\n\r\n\t\tif (this.defaultStyles) {\r\n\t\t\tthis.loadDefaultCSS();\r\n\t\t}\r\n\r\n\t\t// Selector wrapper\r\n\t\tif (!this._elements.wrapper) {\r\n\t\t\tthis._elements.wrapper = document.createElement(\"div\");\r\n\t\t\tthis._elements.wrapper.className = this.classPrefix + \"-wrapper \" + this.classPrefix + \"-\" + this.position;\r\n\t\t\tthis.container.appendChild(this._elements.wrapper);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Destroys the control and all its elements.\r\n\t */\r\n\tpublic dispose(): void {\r\n\t\tif (!this._disposed) {\r\n\t\t\tsuper.dispose();\r\n\r\n\t\t\tif (this._element && this._element.parentNode) {\r\n\t\t\t\tthis._element.parentNode.removeChild(this._element);\r\n\t\t\t}\r\n\r\n\t\t\tif (this._elements.wrapper && this._elements.wrapper.parentNode) {\r\n\t\t\t\tthis._elements.wrapper.parentNode.removeChild(this._elements.wrapper);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Getters and setters\r\n\t */\r\n\r\n\t/**\r\n\t * An HTML container to place the control in.\r\n\t *\r\n\t * A container must be an HTML element, because the control itself is HTML, and\r\n\t * cannot be placed into SVG.\r\n\t *\r\n\t * @param container Reference to container element\r\n\t */\r\n\tpublic set container(container: $type.Optional<HTMLElement>) {\r\n\t\tthis._container = container;\r\n\t\tthis.invalidate();\r\n\t}\r\n\r\n\t/**\r\n\t * @return Container\r\n\t */\r\n\tpublic get container(): $type.Optional<HTMLElement> {\r\n\t\treturn this._container;\r\n\t}\r\n\r\n\t/**\r\n\t * Position of the selector.\r\n\t *\r\n\t * Available options: `\"top\"`, `\"bottom\"`, `\"left\"` (default), and `\"right\"`.\r\n\t *\r\n\t * NOTE: since the control is always placed in the external container, this\r\n\t * setting does actually affect where the control is placed but rather\r\n\t * default CSS that affects how specific elements are arranged.\r\n\t *\r\n\t * For example, when setting position to `\"top\"` or `\"bottom\"`, the control\r\n\t * will be arranged in a horizontal fashion.\r\n\t *\r\n\t * Similarly, for `\"left\"` and `\"right\"` the control will arrange itself\r\n\t * vertically, which is more suitable for narrow containers.\r\n\t *\r\n\t * @default \"left\"\r\n\t * @param  value  Position\r\n\t */\r\n\tpublic set position(value: \"top\" | \"bottom\" | \"left\" | \"right\") {\r\n\t\tif (this._position != value) {\r\n\t\t\tconst prevPosition = this._position;\r\n\t\t\tthis._position = value;\r\n\t\t\tthis.dispatchImmediately(\"positionset\", {\r\n\t\t\t\ttype: \"positionset\",\r\n\t\t\t\tposition: value,\r\n\t\t\t\tprevPosition: prevPosition\r\n\t\t\t});\r\n\t\t\tthis.invalidate();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @return Position\r\n\t */\r\n\tpublic get position(): \"top\" | \"bottom\" | \"left\" | \"right\" {\r\n\t\treturn this._position;\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates whether [[RangeSelector]] should load external CSS to style\r\n\t * itself.\r\n\t *\r\n\t * If set to `false`, the elements will not be styled, and will rely on some\r\n\t * external CSS.\r\n\t *\r\n\t * @default true\r\n\t * @param Should RangeSelector load its own CSS?\r\n\t */\r\n\tpublic set defaultStyles(value: boolean) {\r\n\t\tif (this._defaultStyles != value) {\r\n\t\t\tthis._defaultStyles = value;\r\n\t\t\tif (value) {\r\n\t\t\t\tthis.loadDefaultCSS();\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.invalidate();\r\n\t}\r\n\r\n\t/**\r\n\t * @return Should RangeSelector load its own CSS?\r\n\t */\r\n\tpublic get defaultStyles(): boolean {\r\n\t\treturn this._defaultStyles\r\n\t}\r\n\r\n\t/**\r\n\t * Loads the default CSS.\r\n\t *\r\n\t * @ignore Exclude from docs\r\n\t */\r\n\tpublic loadDefaultCSS(): void {\r\n\t\tthis._disposers.push(selectorCSS($dom.getShadowRoot(this.container), this.classPrefix));\r\n\r\n\t\tif (this._element) {\r\n\t\t\tthis._element.style.display = \"\";\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * A tab index for the menu.\r\n\t *\r\n\t * Tab index will influence the order in which elements on the chart and\r\n\t * the whole page are selected when pressing TAB key.\r\n\t *\r\n\t * @param value Tab index\r\n\t */\r\n\tpublic set tabindex(value: number) {\r\n\t\tthis._tabindex = value;\r\n\t\tthis.invalidate();\r\n\t}\r\n\r\n\t/**\r\n\t * @return Tab index\r\n\t */\r\n\tpublic get tabindex(): number {\r\n\t\treturn this._tabindex;\r\n\t}\r\n\r\n\t/**\r\n\t * A [[Language]] instance.\r\n\t *\r\n\t * @param value An instance of [[Language]]\r\n\t */\r\n\tpublic set language(value: Language) {\r\n\t\tthis._language.set(value, value.events.on(\"localechanged\", (ev) => {\r\n\t\t\tthis.invalidate();\r\n\t\t}));\r\n\t\tthis.invalidate();\r\n\t}\r\n\r\n\t/**\r\n\t * @return A [[Language]] instance to be used\r\n\t */\r\n\tpublic get language(): Language {\r\n\t\tlet language = this._language.get();\r\n\r\n\t\tif (language == null) {\r\n\t\t\tlanguage = new Language();\r\n\r\n\t\t\t// Maybe use one from axis?\r\n\t\t\tif (this._axis) {\r\n\t\t\t\treturn this._axis.language;\r\n\t\t\t}\r\n\r\n\t\t\t// TODO code duplication with `set language()`\r\n\t\t\tthis._language.set(language, language.events.on(\"localechanged\", (ev) => {\r\n\t\t\t\tthis.invalidate();\r\n\t\t\t}));\r\n\t\t}\r\n\r\n\t\treturn language;\r\n\t}\r\n\r\n\t/**\r\n\t * Class name prefix.\r\n\t *\r\n\t * @default \"amexport\"\r\n\t * @param value Class name prefix\r\n\t */\r\n\tpublic set classPrefix(value: string) {\r\n\t\tthis._classPrefix = value;\r\n\t\tthis.invalidate();\r\n\t}\r\n\r\n\t/**\r\n\t * @return Class name prefix\r\n\t */\r\n\tpublic get classPrefix(): string {\r\n\t\treturn this._classPrefix;\r\n\t}\r\n\r\n\t/**\r\n\t * A target axis to use range selector for.\r\n\t * \r\n\t * @param  value  Axis\r\n\t */\r\n\tpublic set axis(value: this[\"_axis\"]) {\r\n\t\tif (this._axis != value) {\r\n\t\t\tthis._axis = value;\r\n\t\t\tthis.prepAxis();\r\n\t\t\tthis.language = value.language;\r\n\t\t\tthis.invalidate();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected prepAxis(): void {\r\n\t\tif (this._axis) {\r\n\t\t\tthis._disposers.push(this._axis.events.on(\"beforedisposed\", (ev) => {\r\n\t\t\t\tthis.dispose();\r\n\t\t\t}));\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @return Axis\r\n\t */\r\n\tpublic get axis(): this[\"_axis\"] {\r\n\t\treturn this._axis;\r\n\t}\r\n\r\n\r\n}\r\n\r\n/**\r\n * Register class in system, so that it can be instantiated using its name from\r\n * anywhere.\r\n *\r\n * @ignore\r\n */\r\nregistry.registeredClasses[\"RangeSelector\"] = RangeSelector;"]}